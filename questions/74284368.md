
# Removing the bounding box generated by OnnxRuntime segmentation

I have a semantic segmentation model trained using the mmdetection repo. Then it is converted to the ONNX format using the mmdeploy repo.
I am using the following OnnxRuntime code to perform segmentation.
    img = cv2.imread(image_path)
    ORIG = img.shape[0]
    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

    mean = np.array([123.675, 116.28, 103.53])
    std = np.array([58.395, 57.12, 57.375])

    x = (
        cv2.resize((img - mean) / std, (RESIZE, RESIZE))
        .transpose(2, 0, 1)[...]
        .astype("f4")
    )
    x = x[np.newaxis, ::]
    outputs = ort_sess.run(None, {"input": x})
    boxes = outputs[0]
    masks = outputs[2]
    alpha = 0.9
    for i, (box, mask) in enumerate(zip(boxes.squeeze(), masks.squeeze())):
        if not ((box > 0).any()):
             continue
        x1, y1, x2, y2 = (box[:4] * (ORIG / RESIZE)).astype(int)
        mask = cv2.resize(mask, ((x2 - x1), (y2 - y1))) * 255
        overlay = img.copy()

        if black_white_mask:
             overlay[y1:y2, x1:x2, 0] = mask
             overlay[y1:y2, x1:x2, 1] = mask
             overlay[y1:y2, x1:x2, 2] = mask
        else:
             overlay[y1:y2, x1:x2, 0] = mask

        bit_idxs = np.argwhere(overlay[y1:y2, x1:x2, 0] > THRESH)

        xmin, ymin = (bit_idxs[:, 1]).min() + x1, (
              bit_idxs[:, 0]
        ).min() + y1
        xmax, ymax = (bit_idxs[:, 1]).max() + x1, (
              bit_idxs[:, 0]
        ).max() + y1

        cv2.addWeighted(overlay, alpha, img, 1 - alpha, 0, img)
        cv2.rectangle(img, (xmin, ymin), (xmax, ymax), (0, 0, 255))

And I got the following segmentation.

I am satisfied with the segmented ROI, however I don't want the non-ROI within the bounding box to be segmented. To better illustrate this, here is a black-white version of the segmentation.

I want to remove the black regions around the white regions. However, the segmentation region is bounded by (x1, y1, x2, y2), not polygon points around the ROI. Is it possible for me to remove the non-ROI given only the top left and bottom right coordinates?

        