
# Can't build ionic-framework of react

I git clone the ionic-framework source code and build it, but fail, my steps are as follows:

git clone https://github.com/ionic-team/ionic-framework.git

cd ionic-framework/core

yarn && yarn build


F:\\Wallet_React\\ionic-framework\\core\>yarn && yarn build
yarn install v1.22.10
warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
\[1/4\] Resolving packages...
success Already up-to-date.
Done in 1.50s.
yarn run v1.22.10
$ npm run clean && npm run build.css && stencil build --es5 --docs-json dist/docs.json && npm run cdnloader

> @ionic/core@6.3.3 clean
> node scripts/clean.js

> @ionic/core@6.3.3 build.css
> npm run css.sass && npm run css.minify

> @ionic/core@6.3.3 css.sass
> sass --embed-sources src/css:./css

> @ionic/core@6.3.3 css.minify
> cleancss -O2 -o ./css/ionic.bundle.css ./css/ionic.bundle.css

\[24:35.8\]  @stencil/core
\[24:36.6\]  v2.19.2
\[25:02.0\]  build, ionic, prod mode, started ...
\[25:02.0\]  transpile started ...
\[25:39.8\]  transpile finished in 37.77 s
\[25:39.8\]  copy started ...
\[25:47.6\]  generate custom elements started ...
\[25:47.6\]  generate hydrate app started ...
\[25:47.6\]  generate lazy started ...
\[26:15.0\]  copy finished (1348 files) in 35.20 s
\[27:56.2\]  generate custom elements finished in 128.57 s
\[27:56.6\]  generate hydrate app finished in 128.98 s
\[28:26.8\]  generate lazy finished in 159.12 s
\[28:26.9\]  generating react-library started ...
\[28:27.0\]  generating vue-library started ...
\[28:27.0\]  generating angular-library started ...
\[28:27.1\]  generate vue-library finished in 123 ms
\[28:27.1\]  generate angular-library finished in 126 ms
\[28:27.1\]  generate react-library finished in 168 ms
\[28:32.8\]  build finished in 210.83 s

> @ionic/core@6.3.3 cdnloader
> node scripts/copy-cdn-loader.js

Done in 276.53s.


cd ..\packages\react

yarn && yarn build


F:\Wallet_React\ionic-framework\packages\react>yarn && yarn build
yarn install v1.22.10
warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
[1/4] Resolving packages...
warning Lockfile has incorrect entry for "@types/react@16.14.0". Ignoring it.
warning @types/react@16.14.0: [WARNING] Use 16.9.56 instead of 16.14.0, reason: https://github.com/DefinitelyTyped/DefinitelyTyped/issues/49713
[2/4] Fetching packages...
info fsevents@2.3.2: The platform "win32" is incompatible with this module.
info "fsevents@2.3.2" is an optional dependency and failed compatibility check. Excluding it from installation.
warning np@6.5.0: The engine "git" appears to be invalid.
[3/4] Linking dependencies...
warning " > tslint-ionic-rules@0.0.21" has incorrect peer dependency "tslint@^5.1.0".
warning "tslint-ionic-rules > tslint-eslint-rules@5.4.0" has incorrect peer dependency "tslint@^5.0.0".
[4/4] Building fresh packages...

success Saved lockfile.
Done in 44.51s.
yarn run v1.22.10
$ npm run clean && npm run copy && npm run compile

> @ionic/react@6.3.3 clean
> rimraf dist && rimraf dist-transpiled && rimraf routing


> @ionic/react@6.3.3 copy
> node scripts/copy.js


> @ionic/react@6.3.3 compile
> npm run tsc && rollup -c


> @ionic/react@6.3.3 tsc
> tsc -p .

node_modules/@types/prettier/index.d.ts:41:54 - error TS2315: Type 'IsTuple' is not generic.

41 type IndexProperties<T extends { length: number }> = IsTuple<T> extends true
                                                        ~~~~~~~~~~

node_modules/@types/prettier/index.d.ts:53:6 - error TS2456: Type alias 'IsTuple' circularly references itself.

53 type IsTuple<T> = T extends [] ? true : T extends [infer First, ...infer Remain] ? IsTuple<Remain> : false;
        ~~~~~~~

node_modules/@types/prettier/index.d.ts:53:65 - error TS2574: A rest element type must be an array type.

53 type IsTuple<T> = T extends [] ? true : T extends [infer First, ...infer Remain] ? IsTuple<Remain> : false;
                                                                   ~~~~~~~~~~~~~~~

node_modules/@types/prettier/index.d.ts:53:84 - error TS2315: Type 'IsTuple' is not generic.

53 type IsTuple<T> = T extends [] ? true : T extends [infer First, ...infer Remain] ? IsTuple<Remain> : false;
                                                                                      ~~~~~~~~~~~~~~~

node_modules/@types/prettier/index.d.ts:96:5 - error TS2589: Type instantiation is excessively deep and possibly infinite.

96     call<
       ~~~~

node_modules/@types/prettier/index.d.ts:131:5 - error TS2589: Type instantiation is excessively deep and possibly infinite.

131     each<
        ~~~~

node_modules/@types/prettier/index.d.ts:165:5 - error TS2589: Type instantiation is excessively deep and possibly infinite.

165     map<
        ~~~

node_modules/@types/react-dom/node_modules/@types/react/index.d.ts:3089:14 - error TS2300: Duplicate identifier 'LibraryManagedAttributes'.

3089         type LibraryManagedAttributes<C, P> = C extends React.MemoExoticComponent<infer T> | React.LazyExoticComponent<infer T>
                  ~~~~~~~~~~~~~~~~~~~~~~~~

  node_modules/@types/react/index.d.ts:2978:14
    2978         type LibraryManagedAttributes<C, P> = C extends React.MemoExoticComponent<infer T> | React.LazyExoticComponent<infer T>
                      ~~~~~~~~~~~~~~~~~~~~~~~~
    'LibraryManagedAttributes' was also declared here.

node_modules/@types/react-dom/node_modules/@types/react/index.d.ts:3102:13 - error TS2717: Subsequent property declarations must have the same type.  Property 'a' must be of type 'DetailedHTMLProps<AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement>', but here has type 'DetailedHTMLProps<AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement>'.

3102             a: React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement>;
                 ~

  node_modules/@types/react/index.d.ts:2989:13
    2989             a: React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement>;
                     ~
    'a' was also declared here.

node_modules/@types/react-dom/node_modules/@types/react/index.d.ts:3103:13 - error TS2717: Subsequent property declarations must have the same type.  Property 'abbr' must be of type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>', but here has type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>'.

3103             abbr: React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
                 ~~~~

  node_modules/@types/react/index.d.ts:2990:13
    2990             abbr: React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
                     ~~~~
    'abbr' was also declared here.

node_modules/@types/react-dom/node_modules/@types/react/index.d.ts:3104:13 - error TS2717: Subsequent property declarations must have the same type.  Property 'address' must be of type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>', but here has type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>'.

3104             address: React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
                 ~~~~~~~

  node_modules/@types/react/index.d.ts:2991:13
    2991             address: React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
                     ~~~~~~~
    'address' was also declared here.

node_modules/@types/react-dom/node_modules/@types/react/index.d.ts:3105:13 - error TS2717: Subsequent property declarations must have the same type.  Property 'area' must be of type 'DetailedHTMLProps<AreaHTMLAttributes<HTMLAreaElement>, HTMLAreaElement>', but here has type 'DetailedHTMLProps<AreaHTMLAttributes<HTMLAreaElement>, HTMLAreaElement>'.

3105             area: React.DetailedHTMLProps<React.AreaHTMLAttributes<HTMLAreaElement>, HTMLAreaElement>;
                 ~~~~

  node_modules/@types/react/index.d.ts:2992:13
    2992             area: React.DetailedHTMLProps<React.AreaHTMLAttributes<HTMLAreaElement>, HTMLAreaElement>;
                     ~~~~
    'area' was also declared here.

node_modules/@types/react-dom/node_modules/@types/react/index.d.ts:3106:13 - error TS2717: Subsequent property declarations must have the same type.  Property 'article' must be of type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>', but here has type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>'.

3106             article: React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
                 ~~~~~~~

  node_modules/@types/react/index.d.ts:2993:13
    2993             article: React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
                     ~~~~~~~
    'article' was also declared here.

node_modules/@types/react-dom/node_modules/@types/react/index.d.ts:3107:13 - error TS2717: Subsequent property declarations must have the same type.  Property 'aside' must be of type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>', but here has type 'DetailedHTMLProps<HTMLAttributes<HTMLElement>, HTMLElement>'.

3107             aside: React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
                 ~~~~~

Why react will compile fail? packages/vue, packages/vue-router, packages/angular-server can build successfully.
MY OS is Win11, nodejs version is v16.13.0, packages.json of packages/react is
{
  "name": "@ionic/react",
  "version": "6.3.3",
  "description": "React specific wrapper for @ionic/core",
  "keywords": [
    "ionic",
    "framework",
    "react",
    "mobile",
    "app",
    "hybrid",
    "webapp",
    "cordova",
    "progressive web app",
    "pwa"
  ],
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/ionic-team/ionic.git"
  },
  "scripts": {
    "prepublishOnly": "npm run build",
    "build": "npm run clean && npm run copy && npm run compile",
    "clean": "rimraf dist && rimraf dist-transpiled && rimraf routing",
    "compile": "npm run tsc && rollup -c",
    "release": "np --any-branch --yolo --no-release-draft",
    "lint": "tslint --project .",
    "lint.fix": "tslint --project . --fix",
    "tsc": "tsc -p .",
    "copy": "node scripts/copy.js",
    "test.spec": "jest --ci",
    "test.treeshake": "node scripts/treeshaking.js dist/index.esm.js",
    "sync": "sh ./scripts/sync.sh"
  },
  "main": "dist/index.js",
  "module": "dist/index.esm.js",
  "types": "dist/types/index.d.ts",
  "files": [
    "dist/",
    "css/"
  ],
  "dependencies": {
    "@ionic/core": "^6.3.3",
    "ionicons": "^6.0.2",
    "tslib": "*"
  },
  "peerDependencies": {
    "react": ">=16.8.6",
    "react-dom": ">=16.8.6"
  },
  "devDependencies": {
    "@rollup/plugin-node-resolve": "^8.1.0",
    "@rollup/plugin-virtual": "^2.0.3",
    "@testing-library/jest-dom": "^5.11.6",
    "@testing-library/react": "^11.2.2",
    "@testing-library/react-hooks": "^7.0.1",
    "@types/jest": "^26.0.15",
    "@types/node": "^14.0.14",
    "@types/react": "16.14.0",
    "@types/react-dom": "^16.9.0",
    "fs-extra": "^9.0.1",
    "jest": "^26.6.3",
    "np": "^6.4.0",
    "prettier": "^2.2.0",
    "react": "^16.9.0",
    "react-dom": "^16.9.0",
    "rimraf": "^3.0.2",
    "rollup": "^2.26.4",
    "rollup-plugin-sourcemaps": "^0.6.2",
    "ts-jest": "^26.4.4",
    "tslint": "^6.1.2",
    "tslint-ionic-rules": "0.0.21",
    "tslint-react": "^5.0.0",
    "typescript": "^3.9.5"
  },
  "jest": {
    "preset": "ts-jest",
    "setupFilesAfterEnv": [
      "<rootDir>/jest.setup.js"
    ],
    "testPathIgnorePatterns": [
      "cypress",
      "node_modules",
      "dist-transpiled",
      "dist",
      "test-app"
    ],
    "modulePaths": [
      "<rootDir>"
    ]
  }
}

I build ionic-framework/core, ionic-framework/angular, ionic-framework/packages/vue, ionic-framework/packages/vue-router and ionic-framework/packages/angular-server are OK, only build ionic-framework/packages/react and ionic-framework/packages/react-router are fail. I want to build react success.

        